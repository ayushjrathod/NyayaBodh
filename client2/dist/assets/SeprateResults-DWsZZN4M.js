import{j as e,q as s,r as a,b as t,v as r}from"./ui-C1FR33ZW.js";import{l,a as n}from"./pdf-BWcaFJKc.js";import{a as d}from"./utils-COlzZPg4.js";import{r as i,R as o}from"./vendor-DMlfRnyX.js";import{a as c,E as m,g as x}from"./index-GHVuBVY8.js";import{S as u,W as h}from"./index-DBcSKZvY.js";import{b as g,d as j}from"./router-Dze4JIbL.js";import"./charts-jwwhqExT.js";import"./auth-Bdeye9u2.js";import"./forms-BirKV14m.js";const b=()=>{const b=g(),{uuid:p}=j(),f=c(e=>e.theme.isDarkMode),N=b.state||{},{searchType:y,metadata:v,summary:k,petitioner:E,respondent:w,entities:R,SemanticResultData:D,EntityResultData:S}=N,T=S||"entity"===y,U=D||"semantic"===y;let C=null;U&&D?C=D.find(e=>e.uuid===p):T&&S?C=S.find(e=>e.uuid===p):(v||k)&&(C={uuid:p,summary:k,petitioner:E,respondent:w,entities:R,metadata:v});const O=(null==C?void 0:C.summary)||k||"No summary available.",F=(null==C?void 0:C.metadata)||v||{},P=(null==C?void 0:C.petitioner)||(null==F?void 0:F.PETITIONER)||E||"Unknown",A=(null==C?void 0:C.respondent)||(null==F?void 0:F.RESPONDENT)||w||"Unknown",_=(null==C?void 0:C.entities)||R||"N/A",I=[{label:"Date",value:null==F?void 0:F.DATE},{label:"Court",value:null==F?void 0:F.COURT},{label:"Judge",value:null==F?void 0:F.JUDGE},{label:"Case No",value:null==F?void 0:F.CASE_NUMBER}].filter(e=>Boolean(e.value)),[$,z]=i.useState(null),L=l.defaultLayoutPlugin(),[G,B]=i.useState(!1),[J,M]=i.useState(null),[W,V]=i.useState(!0),[q,H]=i.useState({}),K=e=>{H(s=>({...s,[e]:!s[e]}))},Y=(e=!0)=>{const s=["summary_preview","date","judge","court","case_number","lawyer","org","other_person","precedent","provision","statute","petitioner","respondent","entities"];F&&Object.keys(F).forEach(e=>{s.push(`metadata_${e}`)});const a={};s.forEach(s=>{a[s]=e}),H(a)},Q=Object.values(q).some(Boolean),X=Object.values(q).filter(Boolean).length,Z=(e,s)=>{"Enter"!==e.key&&" "!==e.key||(e.preventDefault(),K(s))},ee=(s,a,t=200)=>{if(!s||s.length<=t)return e.jsx("span",{className:"break-words leading-relaxed",children:s});const r=q[a],l=t,n=s.split(" ").length,d=Math.ceil(l/5);return r?e.jsxs("span",{className:"break-words leading-relaxed",children:[s," ",e.jsx("button",{onClick:()=>K(a),onKeyDown:e=>Z(e,a),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium underline ml-1 inline-flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300 rounded-sm","aria-label":`Collapse ${a.replace("_"," ")} text`,"aria-expanded":"true",tabIndex:0,children:"Show less"})]}):e.jsxs("span",{className:"break-words leading-relaxed",children:[s.substring(0,t),e.jsx("span",{className:"text-gray-400 mx-1",children:"..."}),e.jsx("button",{onClick:()=>K(a),onKeyDown:e=>Z(e,a),className:"text-blue-600 hover:text-blue-800 dark:text-blue-400 dark:hover:text-blue-300 text-sm font-medium underline ml-1 inline-flex items-center transition-colors focus:outline-none focus:ring-2 focus:ring-blue-300 rounded-sm","aria-label":`Expand ${a.replace("_"," ")} text (${n>d?`~${n-d} more words`:"more"})`,"aria-expanded":"false",tabIndex:0,children:"Show more"})]})};return i.useEffect(()=>{let e;return(async()=>{var s,a,t,r,l;if(!p)return M("No UUID provided"),void V(!1);V(!0),M(null);try{const t=await d({method:"GET",url:`${x.baseURL}/get-file/${p}`,responseType:"blob",headers:{Accept:"application/pdf"},validateStatus:function(e){return e>=200&&e<300},timeout:3e4});if(!(null==(s=t.data)?void 0:s.size))throw new Error("Empty PDF received");if(!(null==(a=t.headers["content-type"])?void 0:a.includes("application/pdf")))throw new Error(`Invalid content type: ${t.headers["content-type"]}`);e=URL.createObjectURL(t.data),z(e)}catch(n){let e="Failed to fetch PDF";e=n.response?`Server error: ${n.response.status} - ${(null==(r=null==(t=n.response)?void 0:t.data)?void 0:r.detail)||(null==(l=n.response)?void 0:l.statusText)}`:n.request?"No response from server":n.message,M(e)}finally{V(!1)}})(),()=>{e&&URL.revokeObjectURL(e)}},[p]),p?C||k?e.jsx("div",{className:"min-h-screen font-Inter bg-background text-foreground",children:e.jsxs("div",{className:"container mx-auto p-4",children:[e.jsx("h1",{className:"text-lg sm:text-xl font-bold mb-6 break-words leading-tight",children:C?`${P} v. ${A}`:"Case Details Not Available"}),I.length>0&&e.jsx("div",{className:"flex flex-wrap gap-2 mb-4",children:I.map(s=>e.jsxs("span",{className:"inline-flex items-center gap-2 px-3 py-1 rounded-full border border-default-200 bg-default-50 text-xs font-medium",children:[e.jsxs("span",{className:"text-default-500",children:[s.label,":"]}),e.jsx("span",{className:"text-foreground",children:s.value})]},s.label))}),e.jsxs(u,{sizes:[50,50],minSize:100,expandToMin:!1,gutterSize:10,gutterAlign:"center",snapOffset:30,dragInterval:1,direction:"horizontal",cursor:"ew-resize",className:"flex h-[calc(100vh-150px)]",gutter:(e,s)=>{const a=document.createElement("div");return a.className=`gutter gutter-${s} bg-gray-300 rounded-full max-w-[5px] dark:bg-gray-600 hover:bg-blue-400 dark:hover:bg-blue-500 cursor-ew-resize`,a},children:[e.jsxs("div",{className:"overflow-auto pr-2",children:[" ",e.jsxs(s,{className:"mb-6",children:[e.jsxs(a,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Summary"}),!G&&e.jsx(t,{color:"primary",size:"sm",onClick:()=>B(!0),className:"w-full sm:w-auto",children:"Generate Summary"})]})," ",e.jsx(r,{children:G?e.jsx("div",{className:"prose max-w-none dark:prose-invert",children:e.jsx(h,{words:O})}):e.jsxs("div",{className:"space-y-4",children:[e.jsx("p",{className:"text-gray-500 dark:text-gray-400",children:"Click Generate Summary to view"}),O&&"No summary available."!==O&&e.jsxs("div",{className:"mt-4 p-4 bg-gray-50 dark:bg-gray-800 rounded-lg border border-gray-200 dark:border-gray-700",children:[e.jsx("h3",{className:"font-semibold mb-3 text-gray-800 dark:text-gray-200",children:"Preview:"}),e.jsx("div",{className:"text-sm text-gray-700 dark:text-gray-300 leading-relaxed",children:ee(O,"summary_preview",300)})]})]})})]})," ",e.jsxs(s,{children:[e.jsxs(a,{className:"flex flex-col sm:flex-row justify-between items-start sm:items-center gap-4",children:[e.jsxs("div",{className:"flex flex-col sm:flex-row sm:items-center gap-2",children:[e.jsx("h2",{className:"text-xl font-semibold",children:"Case Details"}),X>0&&e.jsxs("span",{className:"text-sm text-gray-500 dark:text-gray-400 px-2 py-1 bg-gray-100 dark:bg-gray-700 rounded-full",children:[X," expanded"]})]}),e.jsxs("div",{className:"flex flex-wrap gap-2",children:[e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>Y(!0),className:"text-xs",children:"Expand All"}),e.jsx(t,{size:"sm",variant:"ghost",onClick:()=>Y(!1),className:"text-xs",disabled:!Q,children:"Collapse All"})]})]}),e.jsxs(r,{children:[" ",U&&F?e.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[F.DATE&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Date of Judgment:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.DATE,"date",100)})]}),F.JUDGE&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Judges:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.JUDGE,"judge",150)})]}),F.COURT&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Court:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.COURT,"court",100)})]}),F.CASE_NUMBER&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Case Number:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.CASE_NUMBER,"case_number",120)})]}),F.LAWYER&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Lawyers:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.LAWYER,"lawyer",200)})]}),F.ORG&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Organizations:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.ORG,"org",200)})]}),F.OTHER_PERSON&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Other Persons:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.OTHER_PERSON,"other_person",200)})]}),F.PRECEDENT&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Precedents:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.PRECEDENT,"precedent",300)})]}),F.PROVISION&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Provisions:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.PROVISION,"provision",250)})]}),F.STATUTE&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Statutes:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(F.STATUTE,"statute",200)})]})]}):e.jsxs("dl",{className:"grid grid-cols-1 md:grid-cols-2 gap-x-6 gap-y-4",children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Petitioner:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(P,"petitioner",150)}),e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Respondent:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(A,"respondent",150)}),_&&e.jsxs(e.Fragment,{children:[e.jsx("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:"Entities:"}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(_,"entities",200)})]}),F&&Object.entries(F).map(([s,a])=>a&&e.jsxs(o.Fragment,{children:[e.jsxs("dt",{className:"font-semibold text-gray-700 dark:text-gray-300",children:[s.replace(/_/g," ").replace(/\b\w/g,e=>e.toUpperCase()),":"]}),e.jsx("dd",{className:"mb-4 md:mb-0",children:ee(String(a),`metadata_${s}`,200)})]},s))]})]})]})]}),e.jsx("div",{className:"overflow-hidden pl-2",children:e.jsx(n.Worker,{workerUrl:"https://unpkg.com/pdfjs-dist@3.11.174/build/pdf.worker.min.js",children:e.jsxs("div",{style:{height:"100%"},children:[" ",W?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx(m,{size:"md",label:"Loading PDF document...",center:!0})}):J?e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsxs("p",{className:"text-red-500",children:["Error loading PDF: ",J]})}):$?e.jsx(n.Viewer,{theme:f?"dark":"light",fileUrl:$,plugins:[L],onError:e=>{M("Failed to render PDF")}}):e.jsx("div",{className:"flex items-center justify-center h-full",children:e.jsx("p",{children:"No PDF available"})})]})})})]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsxs("div",{className:"text-center",children:[e.jsx("p",{className:"text-lg mb-2",children:"Case not found"}),e.jsxs("p",{className:"text-gray-500",children:["The case with UUID ",p," could not be found in the provided data."]})]})}):e.jsx("div",{className:"min-h-screen flex items-center justify-center",children:e.jsx("p",{children:"No document ID provided"})})};export{b as default};
